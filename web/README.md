# Bedrock KB ChatBot - Web Application

Amazon Bedrock Knowledge Base ã‚’æ´»ç”¨ã—ãŸ AI ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã® Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€Vercel ã® [AI Chatbot ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](https://vercel.com/templates/next.js/nextjs-ai-chatbot) ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€Amazon Bedrock Knowledge Base ã¨çµ±åˆã—ãŸãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ğŸ¯ æ¦‚è¦

Next.js 16 ã¨ Vercel AI SDK ã‚’ä½¿ç”¨ã—ãŸã€ãƒ¢ãƒ€ãƒ³ãª AI ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚Amazon Bedrock Knowledge Base ã¨ã®çµ±åˆã«ã‚ˆã‚Šã€Confluence ãªã©ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’æ´»ç”¨ã—ãŸé«˜åº¦ãªè³ªå•å¿œç­”æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸš€ ä¸»ãªæ©Ÿèƒ½

- **AI ãƒãƒ£ãƒƒãƒˆ**: Vercel AI Gateway çµŒç”±ã§ã® LLM çµ±åˆ
- **Knowledge Base çµ±åˆ**: Amazon Bedrock Knowledge Base ã«ã‚ˆã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢
- **ãƒãƒ£ãƒƒãƒˆå±¥æ­´**: PostgreSQL ã«ã‚ˆã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **èªè¨¼**: Auth.js ã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼
- **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: Vercel Blob ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: Tailwind CSS ã«ã‚ˆã‚‹ãƒ¢ãƒ€ãƒ³ãª UI
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**: AI SDK ã«ã‚ˆã‚‹ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Next.js 16** - React ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆApp Routerï¼‰
- **React 19** - UI ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **AI SDK** - LLM çµ±åˆ
- **Vercel AI Gateway** - AI ãƒ¢ãƒ‡ãƒ«ã¸ã®çµ±åˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **Amazon Bedrock** - Knowledge Base & LLM
- **Tailwind CSS 4** - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã® CSS
- **TypeScript 5** - å‹å®‰å…¨æ€§
- **Drizzle ORM** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ORM
- **Auth.js** - èªè¨¼
- **Vercel Blob** - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **Redis** - ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **Biome** - Linter & Formatter

## ğŸ“‹ å‰ææ¡ä»¶

- Node.js 20.x ä»¥ä¸Š
- pnpm 10.x ä»¥ä¸Š
- Vercel ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆï¼‰
- AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆBedrock Knowledge Base ãŒå¿…è¦ï¼‰

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ï¼š

```bash
cp .env.example .env
```

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼š

```bash
# èªè¨¼ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãª32æ–‡å­—ã®æ–‡å­—åˆ—ï¼‰
# https://generate-secret.vercel.app/32 ã¾ãŸã¯ openssl rand -base64 32
AUTH_SECRET=your-secret-key

# AI Gateway API ã‚­ãƒ¼ï¼ˆé Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ã®å ´åˆã®ã¿å¿…è¦ï¼‰
# Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ã§ã¯ OIDC ãƒˆãƒ¼ã‚¯ãƒ³ãŒè‡ªå‹•ä½¿ç”¨ã•ã‚Œã¾ã™
# https://vercel.com/ai-gateway
AI_GATEWAY_API_KEY=your-ai-gateway-key

# Vercel Blob ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
# https://vercel.com/docs/storage/vercel-blob
BLOB_READ_WRITE_TOKEN=your-blob-token

# PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
# https://vercel.com/docs/storage/vercel-postgres
POSTGRES_URL=your-postgres-url

# Redisï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
# https://vercel.com/docs/storage/vercel-kv
REDIS_URL=your-redis-url

# AWS èªè¨¼æƒ…å ±
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_REGION=us-east-1

# Amazon Bedrock Knowledge Base ID
# ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«å–å¾—
KNOWLEDGE_BASE_ID=your-knowledge-base-id
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
pnpm db:migrate
```

### 4. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
pnpm dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ [http://localhost:3000](http://localhost:3000) ã‚’é–‹ãã¾ã™ã€‚

## ğŸ“ é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```bash
pnpm dev        # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ï¼ˆTurbopackï¼‰
pnpm build      # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
pnpm start      # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
pnpm lint       # Biome ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰æ¤œæŸ»
pnpm format     # Biome ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
pnpm test       # Playwright ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒãƒ³ãƒ‰

```bash
pnpm db:generate # Drizzle ã‚¹ã‚­ãƒ¼ãƒã®ç”Ÿæˆ
pnpm db:migrate  # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ
pnpm db:studio   # Drizzle Studioï¼ˆGUIï¼‰ã®èµ·å‹•
pnpm db:push     # ã‚¹ã‚­ãƒ¼ãƒã®ç›´æ¥é©ç”¨
pnpm db:pull     # æ—¢å­˜ DB ã‹ã‚‰ã‚¹ã‚­ãƒ¼ãƒå–å¾—
```

## ğŸ—‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
web/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/              # èªè¨¼ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ (chat)/              # ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ api/                 # API ãƒ«ãƒ¼ãƒˆ
â”œâ”€â”€ components/              # React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ui/                  # UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆshadcn/uiï¼‰
â”‚   â””â”€â”€ custom/              # ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ lib/                     # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ ai/                  # AI çµ±åˆãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ db/                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
â”‚   â””â”€â”€ utils/               # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”œâ”€â”€ public/                  # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ drizzle/                 # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â””â”€â”€ package.json
```

## ğŸ”‘ AI Gateway ã®è¨­å®š

ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ [Vercel AI Gateway](https://vercel.com/docs/ai-gateway) ã‚’ä½¿ç”¨ã—ã¦è¤‡æ•°ã® AI ãƒ¢ãƒ‡ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

### Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ã®å ´åˆ
èªè¨¼ã¯ OIDC ãƒˆãƒ¼ã‚¯ãƒ³ã§è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚

### é Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ã®å ´åˆ
`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã« `AI_GATEWAY_API_KEY` ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ¢ãƒ‡ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®å¤‰æ›´

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ Amazon Bedrock ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€[AI SDK](https://ai-sdk.dev/docs/introduction) ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ä»–ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ç°¡å˜ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ï¼š

- OpenAI
- Anthropic
- Cohere
- ãã®ä»–å¤šæ•°

è©³ç´°ã¯ [AI SDK ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://ai-sdk.dev/providers/ai-sdk-providers) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“¦ Vercel ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ‡ãƒ—ãƒ­ã‚¤

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/your-repo/bedrock-kb-chatbot)

### æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Vercel CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i -g vercel

# ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ Vercel ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªãƒ³ã‚¯
vercel link

# ç’°å¢ƒå¤‰æ•°ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
vercel env pull

# ãƒ‡ãƒ—ãƒ­ã‚¤
vercel deploy --prod
```

## ğŸ¨ UI ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [shadcn/ui](https://ui.shadcn.com) ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿½åŠ ï¼š

```bash
pnpx shadcn@latest add [component-name]
```

## ğŸ” èªè¨¼

Auth.js ã‚’ä½¿ç”¨ã—ãŸèªè¨¼ã‚·ã‚¹ãƒ†ãƒ ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚

èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®è¨­å®šã¯ [lib/auth/config.ts](lib/auth/config.ts) ã§è¡Œã„ã¾ã™ã€‚

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

Playwright ã‚’ä½¿ç”¨ã—ãŸ E2E ãƒ†ã‚¹ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

```bash
pnpm test
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’ç¢ºèª
pnpm db:studio
```

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
rm -rf .next
pnpm build
```

### ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª

```bash
# ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
vercel env pull
```

## ğŸ“š å‚è€ƒè³‡æ–™

- [Next.js Documentation](https://nextjs.org/docs)
- [AI SDK Documentation](https://ai-sdk.dev/docs)
- [Vercel AI Gateway](https://vercel.com/docs/ai-gateway)
- [Amazon Bedrock Documentation](https://docs.aws.amazon.com/bedrock/)
- [shadcn/ui](https://ui.shadcn.com)
- [Drizzle ORM](https://orm.drizzle.team)
- [Auth.js](https://authjs.dev)

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add some amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ Vercel AI Chatbot ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ã€‚

## ğŸ™ è¬è¾

- [Vercel AI Chatbot Template](https://github.com/vercel/ai-chatbot)
- [Vercel AI SDK](https://sdk.vercel.ai)
- [shadcn/ui](https://ui.shadcn.com)
